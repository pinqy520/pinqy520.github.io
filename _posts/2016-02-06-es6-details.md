---
title: ES6细节笔记
updated: 2016-02-06 23:45
---

> 在已经使用过es6中比较实用的特性，如：Promise、模板字符串、Class、结构赋值等之后，可能并未对某些功能的细节进行深究，然而其实这些细节也同样使得JavaScript越来越好了。

## 0x00 关于变量的作用域（let、const、var、function）

es5语法中可以通过`var`和`function`的方式声明变量，使用它们声明的变量会再其作用域中发生变量提升，其作用域也只分为函数作用域和全局作用域，用立即执行函数生成闭包。例如：

**普通变量声明**

```javascript
var a = 0
function b() { ... }
var c = 1
```
其实等价于

``` javascript
var b = function () { ... }
var a, c // undefined
/* ---- 变量提升的分割线 ---- */
a = 0
c = 1
```

**变量改动**

``` javascript
b()
console.log(a) // 不报错 10
console.log(c) // 不报错 undefined
console.log(d) // 报错 Error: d is not defined
var a, c
function b() {
    a = 10
}
```

其实等价于

``` javascript
var b = function() {
    a = 10
}
var a, c // undefined
/* ---- 变量提升的分割线 ---- */
b()
console.log(a) // 不报错 10
console.log(c) // 不报错 undefined
console.log(d) // 报错 Error: d is not defined
```

**局部变量声明**

下面几种情况造成不同的结果很有意思

``` javascript
var a = 1
function b () {
    a = 10 // 外围作用域的变量a赋值
    console.log(a) // 10
}
b()
console.log(a) // 10
```

``` javascript
var a = 1
function b () {
    var a = 10 // 声明局部变量，只在当前作用域范围内生效
    console.log(a) // 10
}
b()
console.log(a) // 1
```

``` javascript
var a = 1
function b () {
    a = 10
    console.log(a) // 10
    return
    function a () {}
}
b()
console.log(a) // 1
```

大家可能对这个结果有些疑惑，原因是它其实等价于：

``` javascript
var a = 1
function b () {
    var a = function () {} // 声明局部变量
    a = 10
    console.log(a) // 10
    return
}
b()
console.log(a) // 1
```

**立即执行函数闭包**

``` javascript
(function() {
    console.log(a) // 不报错 undefined
    var a
})()
console.log(a) // 报错 Error: a is not defined
```

灵活是灵活，但是确认很多代码看起来不够直观。

另外，上面被函数中大括号`{...}`包含在内的区域是一个作用域，而再条件语句`if(...){...}`或者循环语句`for(...) {...}`等等中则不是。

因此，在es6中，新增了`let`和`const`以及块级作用域来让代码更易于逻辑梳理，也有一些前端用起来不习惯的地方，也产生了许多新的特性，例如：TDZ (Temporal Dead Zone 暂时性死区)。

### `let`和`const`相比`var`和`function`有哪些不同？

**三点：**

- 变量提升没了
- 不允许重复声明
- 作用域为块级作用域

关于这三点可以看下面几个例子：



### 用法总结

## 0x01 结构赋值的圆括号

JavaScript中被大括号括起来的区域`{...}`可能有多种含义：

- 代码块
- 对象

而在ES6中又多了一种情况：

- 结构赋值中的模式

**我们先回顾一下ES6中的结构赋值**



## 0x02 标签模板

很多人已经知道ES6中可以使用这样的字符串模板，让字符串拼接更加简单：

``` javascript
let w = 'world'
let a = `Hello ${w}` // Hello world
```

却不知还有这样的使用方式：

``` javascript
function c() {...}
let a = c`Hello ${1} World`
```

### 用法总结

## 0x03 数值的扩展

